<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RFQ-Dashboard 2020-2024</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',system-ui,sans-serif;background:#f5f7fa;color:#333;padding:20px;min-height:100vh}
.dashboard{max-width:1400px;margin:0 auto}
h1{text-align:center;color:#2c3e50;margin-bottom:20px;font-size:28px}
.filter-bar{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,.1);display:flex;flex-wrap:wrap;gap:15px;align-items:center}
.filter-group{display:flex;flex-direction:column;gap:5px}
.filter-group label{font-weight:600;color:#555;font-size:13px}
select{padding:10px 15px;border-radius:8px;border:1px solid #ddd;font-size:14px;min-width:150px;cursor:pointer;background:#fff}
select:disabled{background:#eee;cursor:not-allowed;color:#999}
.btn{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s}
.btn-execute{background:#3498db;color:#fff}
.btn-execute:hover{background:#2980b9}
.btn-reset{background:#e74c3c;color:#fff}
.btn-reset:hover{background:#c0392b}
.status-box{flex:1;text-align:right;font-size:14px;color:#666;padding:10px;background:#f8f9fa;border-radius:8px}
.kpi-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-bottom:20px}
.kpi-card{background:#fff;border-radius:12px;padding:25px;box-shadow:0 2px 10px rgba(0,0,0,.1);position:relative;overflow:hidden}
.kpi-card::before{content:'';position:absolute;top:0;left:0;width:5px;height:100%}
.kpi-card.blue::before{background:#3498db}
.kpi-card.comparison::before{background:linear-gradient(#2ecc71,#e74c3c)}
.kpi-card.orange::before{background:#f39c12}
.kpi-title{font-size:14px;color:#888;margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}
.kpi-value{font-size:36px;font-weight:700;color:#2c3e50}
.kpi-card.blue .kpi-value{color:#3498db}
.kpi-card.orange .kpi-value{color:#f39c12}
.comparison-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.comparison-item{text-align:center}
.comparison-label{font-size:12px;color:#888;margin-bottom:3px}
.comparison-value{font-size:24px;font-weight:700}
.comparison-value.current{color:#2ecc71}
.comparison-value.previous{color:#e74c3c}
.comparison-vs{font-size:16px;color:#999;font-weight:600}
.comparison-diff{display:flex;justify-content:space-between;padding-top:15px;border-top:1px solid #eee}
.diff-item{text-align:center}
.diff-label{font-size:11px;color:#888}
.diff-value{font-size:18px;font-weight:600}
.diff-value.positive{color:#2ecc71}
.diff-value.negative{color:#e74c3c}
.charts-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px;margin-bottom:20px}
.chart-card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 10px rgba(0,0,0,.1)}
.chart-title{font-size:16px;font-weight:600;color:#2c3e50;margin-bottom:15px;text-align:center}
.chart-container{width:100%;height:300px;position:relative}
.placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#999;font-size:16px;text-align:center}
.placeholder-icon{font-size:48px;margin-bottom:10px}
.table-card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 10px rgba(0,0,0,.1)}
.table-title{font-size:16px;font-weight:600;color:#2c3e50;margin-bottom:15px}
table{width:100%;border-collapse:collapse}
th,td{padding:12px;text-align:center;border-bottom:1px solid #eee}
th{background:#f8f9fa;font-weight:600;color:#555}
th:first-child,td:first-child{text-align:left}
tr:hover{background:#f8f9fa}
.highlight-row{background:#fffde7!important}
.positive{color:#2ecc71}
.negative{color:#e74c3c}
@media(max-width:768px){.filter-bar{flex-direction:column;align-items:stretch}.status-box{text-align:center}.charts-row{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="dashboard">
<h1>üìä RFQ-Dashboard 2020-2024</h1>
<div class="filter-bar">
<div class="filter-group">
<label>Jahr</label>
<select id="yearFilter">
<option value="">Alle Jahre</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
</select>
</div>
<div class="filter-group">
<label>Monat</label>
<select id="monthFilter" disabled>
<option value="">Alle Monate</option>
<option value="1">Januar</option>
<option value="2">Februar</option>
<option value="3">M√§rz</option>
<option value="4">April</option>
<option value="5">Mai</option>
<option value="6">Juni</option>
<option value="7">Juli</option>
<option value="8">August</option>
<option value="9">September</option>
<option value="10">Oktober</option>
<option value="11">November</option>
<option value="12">Dezember</option>
</select>
</div>
<button class="btn btn-execute" onclick="applyFilters()">üîç Ausf√ºhren</button>
<button class="btn btn-reset" onclick="resetFilters()">‚Üª Zur√ºcksetzen</button>
<div class="status-box" id="statusBox">üìä Zeige: Alle Daten (37.348 RFQs)</div>
</div>
<div class="kpi-container">
<div class="kpi-card blue">
<div class="kpi-title">Gesamt RFQs</div>
<div class="kpi-value" id="kpiTotal">37.348</div>
</div>
<div class="kpi-card comparison">
<div class="kpi-title">Jahresvergleich</div>
<div class="comparison-row">
<div class="comparison-item">
<div class="comparison-label" id="currentLabel">2024</div>
<div class="comparison-value current" id="currentValue">3.264</div>
</div>
<div class="comparison-vs">vs.</div>
<div class="comparison-item">
<div class="comparison-label" id="previousLabel">2023</div>
<div class="comparison-value previous" id="previousValue">10.945</div>
</div>
</div>
<div class="comparison-diff">
<div class="diff-item">
<div class="diff-label">Absolut</div>
<div class="diff-value" id="diffAbsolute">-7.681 RFQs</div>
</div>
<div class="diff-item">
<div class="diff-label">Prozentual</div>
<div class="diff-value" id="diffPercent">-70,2%</div>
</div>
</div>
</div>
<div class="kpi-card orange">
<div class="kpi-title">Lieferanten</div>
<div class="kpi-value">2.221</div>
</div>
</div>
<div class="charts-row">
<div class="chart-card">
<div class="chart-title" id="barChartTitle">RFQs pro Jahr</div>
<div class="chart-container" id="barChart"></div>
</div>
<div class="chart-card">
<div class="chart-title" id="pieChartTitle">Anteil pro Jahr</div>
<div class="chart-container" id="pieChart"></div>
</div>
</div>
<div class="charts-row">
<div class="chart-card" style="grid-column:1/-1">
<div class="chart-title" id="comboChartTitle">Monatlicher Vergleich</div>
<div class="chart-container" id="comboChart"></div>
</div>
</div>
<div class="table-card">
<div class="table-title">Monatliche Vergleichstabelle</div>
<table>
<thead>
<tr>
<th>Monat</th>
<th id="colYear1">2024 üü¢</th>
<th id="colYear2">2023 üî¥</th>
<th>Differenz</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>
</div>
<script>
const yearlyData={2020:2340,2021:9820,2022:10979,2023:10945,2024:3264};
const monthlyData={
2019:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0},
2020:{1:0,2:17,3:34,4:16,5:37,6:199,7:306,8:224,9:284,10:358,11:430,12:435},
2021:{1:599,2:758,3:909,4:878,5:817,6:824,7:977,8:639,9:896,10:911,11:871,12:741},
2022:{1:743,2:1115,3:1166,4:798,5:947,6:991,7:1074,8:629,9:894,10:951,11:897,12:774},
2023:{1:799,2:817,3:1020,4:816,5:1027,6:1030,7:1072,8:694,9:947,10:962,11:1014,12:747},
2024:{1:958,2:1068,3:1050,4:188,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0}
};
const monthNames=['','Januar','Februar','M√§rz','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'];
const colors={2020:'#9b59b6',2021:'#1abc9c',2022:'#e74c3c',2023:'#3498db',2024:'#f39c12'};
const fmt=n=>n.toLocaleString('de-DE');
let currentYear='',currentMonth='';

document.getElementById('yearFilter').addEventListener('change',function(){
  const mf=document.getElementById('monthFilter');
  mf.disabled=!this.value;
  if(!this.value)mf.value='';
});

function applyFilters(){
  currentYear=document.getElementById('yearFilter').value;
  currentMonth=document.getElementById('monthFilter').value;
  updateDashboard();
}

function resetFilters(){
  document.getElementById('yearFilter').value='';
  document.getElementById('monthFilter').value='';
  document.getElementById('monthFilter').disabled=true;
  currentYear='';currentMonth='';
  updateDashboard();
}

function updateDashboard(){
  updateKPIs();updateBarChart();updatePieChart();updateComboChart();updateTable();
}

function updateKPIs(){
  let total,currentVal,prevVal,currentLbl,prevLbl,yr,prevYr;
  if(!currentYear){
    total=37348;yr=2024;prevYr=2023;
    currentVal=yearlyData[2024];prevVal=yearlyData[2023];
    currentLbl='2024';prevLbl='2023';
    document.getElementById('statusBox').textContent='üìä Zeige: Alle Daten ('+fmt(total)+' RFQs)';
  }else if(!currentMonth){
    yr=parseInt(currentYear);prevYr=yr-1;
    total=yearlyData[yr]||0;
    currentVal=yearlyData[yr]||0;prevVal=yearlyData[prevYr]||0;
    currentLbl=yr.toString();prevLbl=prevYr.toString();
    document.getElementById('statusBox').textContent='‚úÖ Zeige: Jahr '+yr+' ('+fmt(total)+' RFQs)';
  }else{
    yr=parseInt(currentYear);prevYr=yr-1;
    const m=parseInt(currentMonth);
    total=(monthlyData[yr]&&monthlyData[yr][m])||0;
    currentVal=total;prevVal=(monthlyData[prevYr]&&monthlyData[prevYr][m])||0;
    currentLbl=monthNames[m]+' '+yr;prevLbl=monthNames[m]+' '+prevYr;
    document.getElementById('statusBox').textContent='‚úÖ Zeige: '+monthNames[m]+' '+yr+' ('+fmt(total)+' RFQs)';
  }
  document.getElementById('kpiTotal').textContent=fmt(total);
  document.getElementById('currentLabel').textContent=currentLbl;
  document.getElementById('currentValue').textContent=fmt(currentVal);
  document.getElementById('previousLabel').textContent=prevLbl;
  document.getElementById('previousValue').textContent=fmt(prevVal);
  const diff=currentVal-prevVal;
  const pct=prevVal?((diff/prevVal)*100):0;
  const dAbs=document.getElementById('diffAbsolute');
  const dPct=document.getElementById('diffPercent');
  dAbs.textContent=(diff>=0?'+':'')+fmt(diff)+' RFQs';
  dAbs.className='diff-value '+(diff>=0?'positive':'negative');
  dPct.textContent=(pct>=0?'+':'')+pct.toFixed(1).replace('.',',')+'%';
  dPct.className='diff-value '+(pct>=0?'positive':'negative');
}

function updateBarChart(){
  const c=document.getElementById('barChart');
  let data=[],labels=[],title,clrs=[];
  if(!currentYear){
    data=[2340,9820,10979,10945,3264];
    labels=['2020','2021','2022','2023','2024'];
    clrs=[colors[2020],colors[2021],colors[2022],colors[2023],colors[2024]];
    title='RFQs pro Jahr';
  }else if(!currentMonth){
    const y=parseInt(currentYear),py=y-1;
    data=[yearlyData[py]||0,yearlyData[y]||0];
    labels=[py.toString(),y.toString()];
    clrs=['#e74c3c','#2ecc71'];title=y+' vs. '+py;
  }else{
    const y=parseInt(currentYear),py=y-1,m=parseInt(currentMonth);
    data=[(monthlyData[py]&&monthlyData[py][m])||0,(monthlyData[y]&&monthlyData[y][m])||0];
    labels=[monthNames[m]+' '+py,monthNames[m]+' '+y];
    clrs=['#e74c3c','#2ecc71'];title=monthNames[m]+' '+y+' vs. '+monthNames[m]+' '+py;
  }
  document.getElementById('barChartTitle').textContent=title;
  const max=Math.max(...data)*1.2;
  const w=c.offsetWidth,h=c.offsetHeight;
  const barW=Math.min(80,w/data.length/1.5);
  const gap=(w-barW*data.length)/(data.length+1);
  let svg=`<svg width="${w}" height="${h}">`;
  for(let i=0;i<4;i++){
    const yPos=h-40-(i*(h-60)/3);
    const val=Math.round(max/3*i/1000);
    svg+=`<line x1="50" y1="${yPos}" x2="${w-10}" y2="${yPos}" stroke="#eee" stroke-width="1"/>`;
    svg+=`<text x="45" y="${yPos+4}" text-anchor="end" fill="#999" font-size="11">${val}K</text>`;
  }
  data.forEach((v,i)=>{
    const barH=(v/max)*(h-70);
    const x=gap+(gap+barW)*i+50;
    const y=h-40-barH;
    svg+=`<rect x="${x}" y="${y}" width="${barW}" height="${barH}" fill="${clrs[i]}" rx="4"/>`;
    svg+=`<text x="${x+barW/2}" y="${y-8}" text-anchor="middle" fill="#333" font-size="12" font-weight="600">${fmt(v)}</text>`;
    svg+=`<text x="${x+barW/2}" y="${h-20}" text-anchor="middle" fill="#666" font-size="11">${labels[i]}</text>`;
  });
  svg+='</svg>';c.innerHTML=svg;
}

function updatePieChart(){
  const c=document.getElementById('pieChart');
  let data=[],labels=[],clrs=[],title;
  if(!currentYear){
    data=[2340,9820,10979,10945,3264];
    labels=['2020','2021','2022','2023','2024'];
    clrs=[colors[2020],colors[2021],colors[2022],colors[2023],colors[2024]];
    title='Anteil pro Jahr';
  }else if(!currentMonth){
    const y=parseInt(currentYear),py=y-1;
    data=[yearlyData[py]||0,yearlyData[y]||0];
    labels=[py.toString(),y.toString()];
    clrs=['#e74c3c','#2ecc71'];title=y+' vs. '+py;
  }else{
    const y=parseInt(currentYear),py=y-1,m=parseInt(currentMonth);
    data=[(monthlyData[py]&&monthlyData[py][m])||0,(monthlyData[y]&&monthlyData[y][m])||0];
    labels=[monthNames[m]+' '+py,monthNames[m]+' '+y];
    clrs=['#e74c3c','#2ecc71'];title=monthNames[m]+' '+y+' vs. '+monthNames[m]+' '+py;
  }
  document.getElementById('pieChartTitle').textContent=title;
  const total=data.reduce((a,b)=>a+b,0);
  const w=c.offsetWidth,h=c.offsetHeight;
  const cx=w/2-60,cy=h/2,r=Math.min(cx,cy)-20;
  let svg=`<svg width="${w}" height="${h}">`,angle=0;
  data.forEach((v,i)=>{
    const pct=v/total;
    const endAngle=angle+pct*2*Math.PI;
    const x1=cx+r*Math.cos(angle),y1=cy+r*Math.sin(angle);
    const x2=cx+r*Math.cos(endAngle),y2=cy+r*Math.sin(endAngle);
    const large=pct>.5?1:0;
    svg+=`<path d="M${cx},${cy} L${x1},${y1} A${r},${r} 0 ${large},1 ${x2},${y2} Z" fill="${clrs[i]}"/>`;
    angle=endAngle;
  });
  let ly=30;
  data.forEach((v,i)=>{
    const pct=((v/total)*100).toFixed(1).replace('.',',');
    svg+=`<rect x="${w-130}" y="${ly}" width="15" height="15" fill="${clrs[i]}" rx="3"/>`;
    svg+=`<text x="${w-110}" y="${ly+12}" fill="#333" font-size="12">${labels[i]}: ${pct}%</text>`;
    ly+=25;
  });
  svg+='</svg>';c.innerHTML=svg;
}

function updateComboChart(){
  const c=document.getElementById('comboChart');
  if(!currentYear){
    c.innerHTML='<div class="placeholder"><div class="placeholder-icon">üìÖ</div>W√§hlen Sie ein Jahr und klicken Sie "Ausf√ºhren"</div>';
    document.getElementById('comboChartTitle').textContent='Monatlicher Vergleich';
    return;
  }
  const y=parseInt(currentYear),py=y-1;
  document.getElementById('comboChartTitle').textContent='Monatlicher Vergleich '+y+' vs. '+py;
  const d1=monthlyData[y]||{},d2=monthlyData[py]||{};
  const w=c.offsetWidth,h=c.offsetHeight;
  const max=Math.max(...Object.values(d1),...Object.values(d2))*1.2||1200;
  const barW=Math.min(40,(w-100)/12-10);
  const gap=((w-80)-(barW*12))/13;
  let svg=`<svg width="${w}" height="${h}">`;
  for(let i=0;i<4;i++){
    const yPos=h-40-(i*(h-70)/3);
    const val=Math.round(max/3*i);
    svg+=`<line x1="50" y1="${yPos}" x2="${w-10}" y2="${yPos}" stroke="#eee" stroke-width="1"/>`;
    svg+=`<text x="45" y="${yPos+4}" text-anchor="end" fill="#999" font-size="10">${fmt(val)}</text>`;
  }
  const selM=currentMonth?parseInt(currentMonth):0;
  for(let m=1;m<=12;m++){
    const v=d1[m]||0;
    const barH=(v/max)*(h-80);
    const x=40+gap*m+barW*(m-1);
    const yp=h-40-barH;
    const fill=selM===m?'#27ae60':'#2ecc71';
    const sw=selM===m?barW+6:barW;
    const sx=selM===m?x-3:x;
    svg+=`<rect x="${sx}" y="${yp}" width="${sw}" height="${barH}" fill="${fill}" rx="3"/>`;
    if(v>0)svg+=`<text x="${x+barW/2}" y="${yp-5}" text-anchor="middle" fill="#2ecc71" font-size="9" font-weight="600">${fmt(v)}</text>`;
    svg+=`<text x="${x+barW/2}" y="${h-25}" text-anchor="middle" fill="#666" font-size="10">${monthNames[m].substr(0,3)}</text>`;
  }
  let path='M';
  for(let m=1;m<=12;m++){
    const v=d2[m]||0;
    const x=40+gap*m+barW*(m-1)+barW/2;
    const yp=h-40-(v/max)*(h-80);
    path+=`${m>1?'L':''}${x},${yp} `;
  }
  svg+=`<path d="${path}" fill="none" stroke="#e74c3c" stroke-width="2.5"/>`;
  for(let m=1;m<=12;m++){
    const v=d2[m]||0;
    const x=40+gap*m+barW*(m-1)+barW/2;
    const yp=h-40-(v/max)*(h-80);
    svg+=`<circle cx="${x}" cy="${yp}" r="5" fill="#e74c3c"/>`;
    if(v>0)svg+=`<text x="${x}" y="${yp-10}" text-anchor="middle" fill="#e74c3c" font-size="9" font-weight="600">${fmt(v)}</text>`;
  }
  svg+=`<rect x="${w-140}" y="10" width="12" height="12" fill="#2ecc71" rx="2"/>`;
  svg+=`<text x="${w-123}" y="20" fill="#333" font-size="11">${y}</text>`;
  svg+=`<line x1="${w-140}" y1="38" x2="${w-128}" y2="38" stroke="#e74c3c" stroke-width="2"/>`;
  svg+=`<circle cx="${w-134}" cy="38" r="4" fill="#e74c3c"/>`;
  svg+=`<text x="${w-123}" y="42" fill="#333" font-size="11">${py}</text>`;
  svg+='</svg>';c.innerHTML=svg;
}

function updateTable(){
  const tb=document.getElementById('tableBody');
  let y1,y2;
  if(!currentYear||currentYear==='2024'){y1=2024;y2=2023;}
  else{y1=parseInt(currentYear);y2=y1-1;}
  document.getElementById('colYear1').textContent=y1+' üü¢';
  document.getElementById('colYear2').textContent=y2+' üî¥';
  const d1=monthlyData[y1]||{},d2=monthlyData[y2]||{};
  const selM=currentMonth?parseInt(currentMonth):0;
  let html='';
  for(let m=1;m<=12;m++){
    const v1=d1[m]||0,v2=d2[m]||0,diff=v1-v2;
    const cls=selM===m?' class="highlight-row"':'';
    const dc=diff>=0?'positive':'negative';
    const ds=diff>=0?'+':'';
    html+=`<tr${cls}><td>${monthNames[m]}</td><td>${fmt(v1)}</td><td>${fmt(v2)}</td><td class="${dc}">${ds}${fmt(diff)}</td></tr>`;
  }
  tb.innerHTML=html;
}

updateDashboard();
window.addEventListener('resize',()=>{updateBarChart();updatePieChart();updateComboChart();});
</script>
</body>
</html>